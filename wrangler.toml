# Top-level configuration
name = "stuuf"
main = "src/index.js"
compatibility_date = "2022-07-12"

workers_dev = false
route = { pattern = "example.org/*", zone_name = "example.org" }

[env.staging]
name = "my-worker-staging"
route = { pattern = "staging.example.org/*", zone_name = "example.org" }

kv_namespaces = [
  { binding = "<MY_NAMESPACE>", id = "<STAGING_KV_ID>" }
]
fun main() {
    @Suppress("UNUSED_VARIABLE")
    val eventListener = EventListener {event ->
        event.asDynamic().respondWith(fetch(event.asDynamic().request as Request))
        Unit
    }
    js("addEventListener('fetch', eventListener)")
}
